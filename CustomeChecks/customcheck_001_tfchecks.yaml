---
checks:
- code: Storage01
  description: Custom check to ensure that AAD authorization is leveraged when accing the Azure portal. This (default_to_oauth_authentication) defaults to false within Terraform. This must be set to true.
  impact: Not setting this value to true may allow for anonymous access. 
  resolution: Set default_to_oauth_authentication to true.
  requiredTypes:
  - resource
  requiredLabels:
  - azurerm_storage_account
  severity: High
  matchSpec:
    name: default_to_oauth_authentication
    action: equals
    value: true
  errorMessage: default_to_oauth_authentication must be set to true.
  relatedLinks:
  - willaddlater.next
- code: Storage02
  description: Do not allow nested items to be public. 
  resolution: Set allow_nested_items_to_be_public to false.
  requiredTypes:
  - resource
  requiredLabels:
  - azurerm_storage_account
  severity: High
  matchSpec:
    name: allow_nested_items_to_be_public
    action: equals
    value: false
  errorMessage: allow_nested_items_to_be_public must be set to false.
  relatedLinks:
  - willaddlater.next
  - code: Storage03
  description: An owner must be identified for the storage account. 
  resolution: Add a tag to the storage account with the owner.
  requiredTypes:
  - resource
  requiredLabels:
  - azurerm_storage_account
  severity: Medium
  matchSpec:
    name: tags
    action: contains
    value: Owner
  errorMessage: Please add a owner to thee storage account.
  relatedLinks:
  - willaddlater.next

